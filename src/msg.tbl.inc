/* character class names */
#define HTTP_CHAR_TOKEN  0x01
#define HTTP_CHAR_CTL    0x02
#define HTTP_CHAR_WSP    0x04
#define HTTP_CHAR_ALPHA  0x08
#define HTTP_CHAR_DIGIT  0x10
#define HTTP_CHAR_HEXDIG 0x20
#define HTTP_CHAR_VCHAR  0x40

/* character class predicate macros */
#define http_ischar(c,f) (((http_chars[(c)&0xff]) & (f)) == (f))
#define http_is_token(c)  (http_ischar((c),HTTP_CHAR_TOKEN))
#define http_is_ctl(c)    (http_ischar((c),HTTP_CHAR_CTL))
#define http_is_wsp(c)    (http_ischar((c),HTTP_CHAR_WSP))
#define http_is_alpha(c)  (http_ischar((c),HTTP_CHAR_ALPHA))
#define http_is_digit(c)  (http_ischar((c),HTTP_CHAR_DIGIT))
#define http_is_hexdig(c) (http_ischar((c),HTTP_CHAR_HEXDIG))
#define http_is_vchar(c)  (http_ischar((c),HTTP_CHAR_VCHAR))
#define http_is_lf(c)     ((c)=='\n')
#define http_is_cr(c)     ((c)=='\r')
#define http_is_htab(c)   ((c)=='\t')
#define http_is_sp(c)     ((c)==' ')
#define http_is_dquote(c) ((c)=='"')

/* amalgamate lookup map of char -> flag */
static char http_chars[] = {
  /* x00 .. x07 */  0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,
  /* x08 .. x0f */  0x02, 0x06, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,
  /* x10 .. x17 */  0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,
  /* x18 .. x1f */  0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,
  /* x20 .. x27 */  0x04, 0x41, 0x40, 0x41, 0x41, 0x41, 0x41, 0x41,
  /* x28 .. x2f */  0x40, 0x40, 0x41, 0x41, 0x40, 0x41, 0x41, 0x40,
  /* x30 .. x37 */  0x71, 0x71, 0x71, 0x71, 0x71, 0x71, 0x71, 0x71,
  /* x38 .. x3f */  0x71, 0x71, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
  /* x40 .. x47 */  0x40, 0x69, 0x69, 0x69, 0x69, 0x69, 0x69, 0x49,
  /* x48 .. x4f */  0x49, 0x49, 0x49, 0x49, 0x49, 0x49, 0x49, 0x49,
  /* x50 .. x57 */  0x49, 0x49, 0x49, 0x49, 0x49, 0x49, 0x49, 0x49,
  /* x58 .. x5f */  0x49, 0x49, 0x49, 0x40, 0x40, 0x40, 0x41, 0x41,
  /* x60 .. x67 */  0x41, 0x69, 0x69, 0x69, 0x69, 0x69, 0x69, 0x49,
  /* x68 .. x6f */  0x49, 0x49, 0x49, 0x49, 0x49, 0x49, 0x49, 0x49,
  /* x70 .. x77 */  0x49, 0x49, 0x49, 0x49, 0x49, 0x49, 0x49, 0x49,
  /* x78 .. x7f */  0x49, 0x49, 0x49, 0x40, 0x41, 0x40, 0x41, 0x00,
  /* x80 .. x87 */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* x88 .. x8f */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* x90 .. x97 */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* x98 .. x9f */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xa0 .. xa7 */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xa8 .. xaf */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xb0 .. xb7 */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xb8 .. xbf */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xc0 .. xc7 */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xc8 .. xcf */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xd0 .. xd7 */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xd8 .. xdf */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xe0 .. xe7 */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xe8 .. xef */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xf0 .. xf7 */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  /* xf8 .. xff */  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
};

